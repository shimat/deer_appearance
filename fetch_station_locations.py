import csv
import requests
from time import sleep


LINES = {
    "函館本線": (
        "函館",
        "五稜郭",
        "桔梗",
        "大中山",
        "七飯",
        "新函館北斗",
        "仁山",
        "大沼",
        "池田園",
        "流山温泉",
        "銚子口",
        "鹿部",
        "渡島沼尻",
        "渡島砂原",
        "掛澗",
        "尾白内",
        "東森",
        "森",
        "桂川",
        "石谷",
        "本石倉",
        "石倉",
        "落部",
        "野田生",
        "山越",
        "八雲",
        "山崎",
        "黒岩",
        "北豊津",
        "国縫",
        "中ノ沢",
        "長万部",
        "二股",
        "蕨岱",
        "黒松内",
        "熱郛",
        "目名",
        "蘭越",
        "昆布",
        "ニセコ",
        "比羅夫",
        "倶知安",
        "小沢",
        "銀山",
        "然別",
        "仁木",
        "余市",
        "蘭島",
        "塩谷",
        "小樽",
        "南小樽",
        "小樽築港",
        "朝里",
        "銭函",
        "ほしみ",
        "星置",
        "稲穂",
        "手稲",
        "稲積公園",
        "発寒",
        "発寒中央",
        "琴似",
        "桑園",
        "札幌",
        "苗穂",
        "白石",
        "厚別",
        "森林公園",
        "大麻",
        "野幌",
        "高砂",
        "江別",
        "豊幌",
        "幌向",
        "上幌向",
        "岩見沢",
        "峰延",
        "光珠内",
        "美唄",
        "茶志内",
        "奈井江",
        "豊沼",
        "砂川",
        "滝川",
        "江部乙",
        "妹背牛",
        "深川",
        "納内",
        "伊納",
        "近文",
        "旭川",
        "大沼公園",
        "赤井川",
        "駒ヶ岳",
        "東山",
        "姫川"
    ),
    "千歳線": (
        "白石",
        "平和",
        "新札幌",
        "上野幌",
        "北広島",
        "島松",
        "恵み野",
        "恵庭",
        "サッポロビール庭園",
        "長都",
        "千歳",
        "南千歳",
        "美々",
        "植苗",
        "沼ノ端",
        "新千歳空港"
    ),
    "宗谷本線": (
        "旭川",
        "旭川四条",
        "新旭川",
        "永山",
        "北永山",
        "南比布",
        "比布",
        "北比布",
        "蘭留",
        "塩狩",
        "和寒",
        "東六線",
        "剣淵",
        "北剣淵",
        "士別",
        "下士別",
        "多寄",
        "瑞穂",
        "風連",
        "東風連",
        "名寄",
        "日進",
        "北星",
        "智恵文",
        "智北",
        "南美深",
        "美深",
        "初野",
        "紋穂内",
        "恩根内",
        "豊清水",
        "天塩川温泉",
        "咲来",
        "音威子府",
        "筬島",
        "佐久",
        "天塩中川",
        "歌内",
        "問寒別",
        "糠南",
        "雄信内",
        "安牛",
        "南幌延",
        "上幌延",
        "幌延",
        "下沼",
        "豊富",
        "徳満",
        "兜沼",
        "勇知",
        "抜海",
        "南稚内",
        "稚内"
    ),
    "室蘭本線": (
        "長万部",
        "静狩",
        "小幌",
        "礼文",
        "大岸",
        "豊浦",
        "洞爺",
        "有珠",
        "長和",
        "伊達紋別",
        "北舟岡",
        "稀府",
        "黄金",
        "崎守",
        "本輪西",
        "東室蘭",
        "鷲別",
        "幌別",
        "富浦",
        "登別",
        "虎杖浜",
        "竹浦",
        "北吉原",
        "萩野",
        "白老",
        "社台",
        "錦岡",
        "糸井",
        "青葉",
        "苫小牧",
        "沼ノ端",
        "遠浅",
        "早来",
        "安平",
        "追分",
        "三川",
        "古山",
        "由仁",
        "栗山",
        "栗丘",
        "栗沢",
        "志文",
        "岩見沢",
        "輪西",
        "御崎",
        "母恋",
        "室蘭"
    ),
    "富良野線": (
        "旭川",
        "神楽岡",
        "緑が丘",
        "西御料",
        "西瑞穂",
        "西神楽",
        "西聖和",
        "千代ヶ岡",
        "北美瑛",
        "美瑛",
        "美馬牛",
        "上富良野",
        "西中",
        "中富良野",
        "鹿討",
        "学田",
        "富良野"
    ),
    "日高本線": (
       "苫小牧",
        "勇払",
        "浜厚真",
        "浜田浦",
        "鵡川",
        "汐見",
        "富川",
        "日高門別",
        "豊郷",
        "清畠",
        "厚賀",
        "大狩部",
        "節婦",
        "新冠",
        "静内",
        "東静内",
        "春立",
        "日高東別",
        "日高三石",
        "蓬栄",
        "本桐",
        "荻伏",
        "絵笛",
        "浦河",
        "東町",
        "日高幌別",
        "鵜苫",
        "西様似",
        "様似", 
    ),
    "札沼線": (
        "桑園",
        "八軒",
        "新川",
        "新琴似",
        "太平",
        "百合が原",
        "篠路",
        "拓北",
        "あいの里教育大",
        "あいの里公園",
        "石狩太美",
        "石狩当別",
        "北海道医療大学",
    ),
    "根室本線": (
        "滝川",
        "東滝川",
        "赤平",
        "茂尻",
        "平岸",
        "芦別",
        "上芦別",
        "野花南",
        "島ノ下",
        "富良野",
        "布部",
        "山部",
        "下金山",
        "金山",
        "東鹿越",
        "幾寅",
        "落合",
        "新得",
        "十勝清水",
        "御影",
        "芽室",
        "大成",
        "西帯広",
        "柏林台",
        "帯広",
        "札内",
        "幕別",
        "利別",
        "池田",
        "十弗",
        "豊頃",
        "新吉野",
        "浦幌",
        "厚内",
        "直別",
        "尺別",
        "音別",
        "古瀬",
        "白糠",
        "西庶路",
        "庶路",
        "大楽毛",
        "新大楽毛",
        "新富士",
        "釧路",
        "東釧路",
        "武佐",
        "別保",
        "上尾幌",
        "尾幌",
        "門静",
        "厚岸",
        "糸魚沢",
        "茶内",
        "浜中",
        "姉別",
        "厚床",
        "初田牛",
        "別当賀",
        "落石",
        "昆布盛",
        "西和田",
        "東根室",
        "根室",
    ),
    "留萌本線": (
        "深川",
        "北一已",
        "秩父別",
        "北秩父別",
        "石狩沼田",
        "真布",
        "恵比島",
        "峠下",
        "幌糠",
        "藤山",
        "大和田",
        "留萌",
    ),
    "石勝線": (
        "南千歳",
        "追分",
        "川端",
        "滝ノ上",
        "新夕張",
        "占冠",
        "トマム",
        "新得",
    ),
    "石北本線": (
        "新旭川",
        "南永山",
        "東旭川",
        "北日ノ出",
        "桜岡",
        "当麻",
        "将軍山",
        "伊香牛",
        "愛別",
        "中愛別",
        "愛山",
        "安足間",
        "東雲",
        "上川",
        "白滝",
        "丸瀬布",
        "瀬戸瀬",
        "遠軽",
        "安国",
        "生野",
        "生田原",
        "西留辺蘂",
        "留辺蘂",
        "相内",
        "東相内",
        "西北見",
        "北見",
        "柏陽",
        "愛し野",
        "端野",
        "緋牛内",
        "美幌",
        "西女満別",
        "女満別",
        "呼人",
        "網走",
    ),
    "釧網本線": (
        "東釧路",
        "遠矢",
        "釧路湿原",
        "細岡",
        "塘路",
        "茅沼",
        "五十石",
        "標茶",
        "磯分内",
        "南弟子屈",
        "摩周",
        "美留和",
        "川湯温泉",
        "緑",
        "札弦",
        "清里町",
        "南斜里",
        "中斜里",
        "知床斜里",
        "止別",
        "浜小清水",
        "原生花園",
        "北浜",
        "藻琴",
        "鱒浦",
        "桂台",
        "網走"
    )
}

with open("station_locations_.csv", "w", encoding="utf-8-sig", newline="") as file:
    csv_writer = csv.writer(file, quoting=csv.QUOTE_NONNUMERIC)
    csv_writer.writerow(("station", "line", "lat", "lon"))
    for line_name, stations in LINES.items():
        for station in stations:
            print(station)
            try:
                key = f"https://uedayou.net/jrslod/北海道旅客鉄道/{line_name}/{station}"
                response = requests.get(f"{key}.json")
                all_data = response.json()
                data = all_data[key]
                lat = data["http://www.w3.org/2003/01/geo/wgs84_pos#lat"][0]["value"]
                lon = data["http://www.w3.org/2003/01/geo/wgs84_pos#long"][0]["value"]
                csv_writer.writerow((station, line_name, float(lat), float(lon)))
                file.flush()
                sleep(1)
            except Exception as e:
                import traceback
                traceback.print_exc()
            